{"meta":{"title":"spOveD","subtitle":null,"description":null,"author":"GyuJung Kim","url":"http://spoved.org"},"pages":[],"posts":[{"title":"Nginx proxy","slug":"nginx-proxy","date":"2018-04-27T11:05:23.000Z","updated":"2018-04-27T13:21:32.998Z","comments":true,"path":"2018/04/27/nginx-proxy/","link":"","permalink":"http://spoved.org/2018/04/27/nginx-proxy/","excerpt":"","text":"프록시123456789101112131415upstream backed &#123; ip_hash; server localhost:8080;&#125;server &#123; listen 80; server_name ; location / &#123; proxy_set_header Host \\$http_host; proxy_set_header X-Real-IP \\$remote_addr; proxy_set_header X-Forwarded-For \\$proxy_add_x_forwarded_for; proxy_pass http://backend; &#125;&#125; server_name은 내용은 상황에 맞게 프록시 + SSL123456789101112131415161718192021222324upstream backed &#123; ip_hash; server localhost:8080;&#125;server &#123; listen 80; server_name ; return 301 https://\\$host\\$request_uri;&#125;server &#123; listen 443 ssl; server_name ; ssl_certificate /etc/letsencrypt/live//fullchain.pem; ssl_certificate_key /etc/letsencrypt/live//privkey.pem; location / &#123; proxy_set_header Host \\$http_host; proxy_set_header X-Real-IP \\$remote_addr; proxy_set_header X-Forwarded-For \\$proxy_add_x_forwarded_for; proxy_pass http://backend; &#125;&#125; server_name과 ssl_certificate 내용은 상황에 맞게 공식 문서 Proxy 접속이 안되는 경우(13: Permission denied) while connecting to upstream1$ cat /var/log/nginx/error.log 1234....2016/12/10 22:51:05 [crit] 813#813: *1 connect() to 127.0.0.1:8080 failed (13: Permission denied) while connecting to upstream, client: 0.0.0.0, server: spoved.org, request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;http://127.0.0.1:8080/&quot;, host: &quot;spoved.org&quot;, referrer: &quot;https://spoved.org/&quot;2016/12/10 22:51:05 [warn] 813#813: *1 upstream server temporarily disabled while connecting to upstream, client: 0.0.0.0, server: spoved.org, request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;http://127.0.0.1:8080/&quot;, host: &quot;spoved.org&quot;, referrer: &quot;https://spoved.org/&quot;.... 해당 경우 아래 명령어 실행 1$ setsebool -P httpd_can_network_connect on stackoverflow","categories":[{"name":"Ops","slug":"Ops","permalink":"http://spoved.org/categories/Ops/"},{"name":"Nginx","slug":"Ops/Nginx","permalink":"http://spoved.org/categories/Ops/Nginx/"}],"tags":[{"name":"ops","slug":"ops","permalink":"http://spoved.org/tags/ops/"},{"name":"nginx","slug":"nginx","permalink":"http://spoved.org/tags/nginx/"}]},{"title":"Nginx Letsencrypt","slug":"nginx-letsencrypt","date":"2018-04-27T03:00:08.000Z","updated":"2018-04-27T10:59:35.364Z","comments":true,"path":"2018/04/27/nginx-letsencrypt/","link":"","permalink":"http://spoved.org/2018/04/27/nginx-letsencrypt/","excerpt":"","text":"CentOS12$ yum install epel-release$ yum install certbot AWS123$ wget https://dl.eff.org/certbot-auto$ chmod a+x certbot-auto$ ./certbot-auto --debug letsencrypt.ini123456789101112131415161718192021222324252627$ cat &lt;&lt;EOT &gt;&gt; letsencrypt-config/ssl.ini# This is an example of the kind of things you can do in a configuration file.# All flags used by the client can be configured here. Run Certbot with# &quot;--help&quot; to learn more about the available options.# Use a 4096 bit RSA key instead of 2048rsa-key-size = 4096# Uncomment and update to register with the specified e-mail addressemail = # Uncomment and update to generate certificates for the specified# domains.domains = # Uncomment to use a text interface instead of ncurses# text = True# Uncomment to use the standalone authenticator on port 443# authenticator = standalone# standalone-supported-challenges = tls-sni-01# Uncomment to use the webroot authenticator. Replace webroot-path with the# path to the public_html / webroot folder being served by your web server.authenticator = webrootwebroot-path = /usr/share/nginx/htmlEOT 도메인 설정사용하는 네임서버를 통하여 서버와 도메인 연결Cloudflare 추천 HTTP 라우팅 설정1$ sudo vim /etc/nginx/conf.d/default.conf server_name 에 도메인 추가ex) server_name localhost spoved.org; 1$ sudo systemctl reload nginx 방화벽 설정firewall 기준 123$ firewall-cmd --permanent --zone=public --add-service=http$ firewall-cmd --permanent --zone=public --add-service=https$ firewall-cmd --reload 실제 SSL 적용12$ certbot certonly -c letsencrypt-config/ssl.ini$ ls -al /etc/letsencrypt/live 성공하면 key가 생성됨.nginx config 파일 설정 1234567891011121314151617server &#123; listen 80; server_name spoved.org; return 301 https://$host$request_uri;&#125;server &#123; listen 443 ssl; server_name spoved.org; client_max_body_size 100M; ssl_certificate /etc/letsencrypt/live/spoved.org/fullchain.pem; ssl_certificate_key /etc/letsencrypt/live/spoved.org/privkey.pem; location / &#123; ... &#125;&#125; 성공 하면 nginx 설정 새로 읽어들이도록 1$ sudo systemctl reload nginx 인증서 자동 갱신 CRONTAB123$ crontab -e0 1 * * * certbot renew0 1 * * * systemctl reload nginx","categories":[{"name":"Ops","slug":"Ops","permalink":"http://spoved.org/categories/Ops/"},{"name":"Nginx","slug":"Ops/Nginx","permalink":"http://spoved.org/categories/Ops/Nginx/"}],"tags":[{"name":"ops","slug":"ops","permalink":"http://spoved.org/tags/ops/"},{"name":"nginx","slug":"nginx","permalink":"http://spoved.org/tags/nginx/"},{"name":"ssl","slug":"ssl","permalink":"http://spoved.org/tags/ssl/"},{"name":"letsencrypt","slug":"letsencrypt","permalink":"http://spoved.org/tags/letsencrypt/"}]},{"title":"Nginx install","slug":"nginx-install","date":"2018-04-27T02:37:03.000Z","updated":"2018-04-27T02:57:05.544Z","comments":true,"path":"2018/04/27/nginx-install/","link":"","permalink":"http://spoved.org/2018/04/27/nginx-install/","excerpt":"","text":"한국 서버가 아닌 경우1$ sudo ln -sf /usr/share/zoneinfo/Asia/Seoul /etc/localtime NGINXnginx.repo 추가 1234567$ cat &lt;&lt;EOT &gt;&gt; /etc/yum.repos.d/nginx.repo[nginx]name=nginx repobaseurl=http://nginx.org/packages/centos/\\$releasever/\\$basearch/gpgcheck=0enabled=1EOT repo 추가 후 설치 123$ sudo yum install nginx$ sudo systemctl enable nginx.service$ sudo systemctl start nginx service 를 쓰는 경우 1$ sudo service nginx start","categories":[{"name":"Ops","slug":"Ops","permalink":"http://spoved.org/categories/Ops/"},{"name":"Nginx","slug":"Ops/Nginx","permalink":"http://spoved.org/categories/Ops/Nginx/"}],"tags":[{"name":"ops","slug":"ops","permalink":"http://spoved.org/tags/ops/"},{"name":"nginx","slug":"nginx","permalink":"http://spoved.org/tags/nginx/"}]},{"title":"Nginx?","slug":"nginx-intro","date":"2018-04-27T02:30:43.000Z","updated":"2018-04-27T02:37:30.719Z","comments":true,"path":"2018/04/27/nginx-intro/","link":"","permalink":"http://spoved.org/2018/04/27/nginx-intro/","excerpt":"","text":"HTTP와 프록시용으로 많이 사용되는 서버. NGINX 공식 홈페이지https://nginx.org/en/","categories":[{"name":"Ops","slug":"Ops","permalink":"http://spoved.org/categories/Ops/"},{"name":"Nginx","slug":"Ops/Nginx","permalink":"http://spoved.org/categories/Ops/Nginx/"}],"tags":[{"name":"ops","slug":"ops","permalink":"http://spoved.org/tags/ops/"},{"name":"nginx","slug":"nginx","permalink":"http://spoved.org/tags/nginx/"}]},{"title":"Jenkins install","slug":"jenkins-install","date":"2018-04-26T12:13:35.000Z","updated":"2018-04-27T02:04:28.751Z","comments":true,"path":"2018/04/26/jenkins-install/","link":"","permalink":"http://spoved.org/2018/04/26/jenkins-install/","excerpt":"","text":"JENKINS123$ sudo wget -O /etc/yum.repos.d/jenkins.repo http://pkg.jenkins-ci.org/redhat/jenkins.repo$ sudo rpm --import https://jenkins-ci.org/redhat/jenkins-ci.org.key$ sudo yum install jenkins yum 을 사용하여 설치하면 추후 젠킨스를 업데이트하기 편합니다. Jenkins wikihttps://wiki.jenkins.io/display/JENKINS/Installing+Jenkins+on+Red+Hat+distributions GITyum 사용이 경우는 보통 구버전의 git이 설치됩니다. 1$ sudo yum install git -y 최신버전을 다운 받아 설치하는 경우 123456789$ export GIT_VER=2.17.0$ wget https://www.kernel.org/pub/software/scm/git/git-$GIT_VER.tar.gz$ tar -zxf git-$GIT_VER.tar.gz$ sudo yum install curl-devel expat-devel gettext-devel openssl-devel perl-devel zlib-devel gcc -y$ cd git-$GIT_VER$ sudo make prefix=/usr all$ sudo make prefix=/usr install Kernel githttps://www.kernel.org/pub/software/scm/git/ JDK123456$ yum list java*jdk-develAvailable Packagesjava-1.6.0-openjdk-devel.x86_64 1:1.6.0.41-1.13.13.1.el7_3 base java-1.7.0-openjdk-devel.x86_64 1:1.7.0.171-2.6.13.0.el7_4 updatesjava-1.8.0-openjdk-devel.i686 1:1.8.0.161-0.b14.el7_4 updatesjava-1.8.0-openjdk-devel.x86_64 1:1.8.0.161-0.b14.el7_4 updates 설치할 JDK 버전 선택하여 설치이 경우는 1.8.0 버전 JDK를 설치 1$ yum install java-1.8.0-openjdk-devel.x86_64 -y 설치된 JDK 확인 123456$ ls /usr/lib/jvm | grep javajavajava-1.8.0java-1.8.0-openjdkjava-1.8.0-openjdk-1.8.0.161-0.b14.el7_4.x86_64java-openjdk 참고자료http://zetawiki.com/wiki/CentOS_JDK_%EC%84%A4%EC%B9%98 GRADLE1234$ sudo yum install zip unzip -y$ curl -s https://get.sdkman.io | bash$ bash$ sdk install gradle 4.7 Gradle Installationhttps://gradle.org/gradle-download/","categories":[{"name":"Ops","slug":"Ops","permalink":"http://spoved.org/categories/Ops/"},{"name":"Jenkins","slug":"Ops/Jenkins","permalink":"http://spoved.org/categories/Ops/Jenkins/"}],"tags":[{"name":"ops","slug":"ops","permalink":"http://spoved.org/tags/ops/"},{"name":"jenkins","slug":"jenkins","permalink":"http://spoved.org/tags/jenkins/"}]},{"title":"Jenkins?","slug":"jenkins-intro","date":"2018-04-26T12:00:10.000Z","updated":"2018-04-27T02:01:58.415Z","comments":true,"path":"2018/04/26/jenkins-intro/","link":"","permalink":"http://spoved.org/2018/04/26/jenkins-intro/","excerpt":"","text":"CI(Continuous Integration, 지속적 통합) 서비스를 제공하는 툴. 간단하게 요약하면 클릭 한 번에 유닛 테스트와 배포를 하도록 도와주는 툴입니다.사람이 직접 배포하면 실수의 귀찮고 위험도 있는데 이런 번거로움을 없애주는 고마운 툴이죠. 젠킨스 공식 홈페이지https://jenkins.io/","categories":[{"name":"Ops","slug":"Ops","permalink":"http://spoved.org/categories/Ops/"},{"name":"Jenkins","slug":"Ops/Jenkins","permalink":"http://spoved.org/categories/Ops/Jenkins/"}],"tags":[{"name":"ops","slug":"ops","permalink":"http://spoved.org/tags/ops/"},{"name":"jenkins","slug":"jenkins","permalink":"http://spoved.org/tags/jenkins/"}]},{"title":"spOveD","slug":"spoved","date":"2018-04-26T11:47:09.524Z","updated":"2018-04-27T02:29:37.896Z","comments":true,"path":"2018/04/26/spoved/","link":"","permalink":"http://spoved.org/2018/04/26/spoved/","excerpt":"","text":"개발과 운영에 관한 내용을 정리하려고 만든 사이트입니다.궁금한 부분은 댓글 달아 주시면 아는 내에서 답해드리겠습니다.","categories":[],"tags":[{"name":"spoved","slug":"spoved","permalink":"http://spoved.org/tags/spoved/"}]}]}